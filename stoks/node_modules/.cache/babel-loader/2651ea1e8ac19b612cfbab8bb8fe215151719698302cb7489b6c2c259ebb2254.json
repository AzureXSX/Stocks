{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// **Github:** https://github.com/fidm/quic\n//\n// **License:** MIT\nconst initialRTTus = 1000; // microsecond\nconst rttAlpha = 0.25;\nconst oneMinusAlpha = 1 - rttAlpha;\nclass RTTStats {\n  constructor() {\n    this.minRTT = 0;\n    this.latestRTT = initialRTTus;\n    this.smoothedRTT = initialRTTus;\n  }\n  get msRTT() {\n    return Math.floor(this.smoothedRTT / 1000);\n  }\n  // TODO: it is a simple version\n  updateRTT(sentTime, rcvTime, ackDelay) {\n    if (sentTime <= 0 || rcvTime <= sentTime) {\n      return;\n    }\n    const sendDelta = (rcvTime - sentTime) * 1000 - ackDelay;\n    if (sendDelta <= 0) {\n      return;\n    }\n    let sample = sendDelta;\n    if (sample > 2 * this.latestRTT) {\n      sample = Math.ceil(0.618 * sample);\n    }\n    this.latestRTT = sample;\n    if (this.minRTT > sample || this.minRTT === 0) {\n      this.minRTT = sample;\n    }\n    this.smoothedRTT = Math.ceil(this.smoothedRTT * oneMinusAlpha + sample * rttAlpha);\n  }\n}\nexports.RTTStats = RTTStats;","map":{"version":3,"names":["initialRTTus","rttAlpha","oneMinusAlpha","RTTStats","constructor","minRTT","latestRTT","smoothedRTT","msRTT","Math","floor","updateRTT","sentTime","rcvTime","ackDelay","sendDelta","sample","ceil","exports"],"sources":["../../src/internal/congestion.ts"],"sourcesContent":[null],"mappings":"AAAA,YAAY;;;;;AACZ;AACA;AACA;AAEA,MAAMA,YAAY,GAAG,IAAI,EAAC;AAC1B,MAAMC,QAAQ,GAAG,IAAI;AACrB,MAAMC,aAAa,GAAG,CAAC,GAAGD,QAAQ;AAElC,MAAAE,QAAA;EAIEC,YAAA;IACE,IAAI,CAACC,MAAM,GAAG,CAAC;IACf,IAAI,CAACC,SAAS,GAAGN,YAAY;IAC7B,IAAI,CAACO,WAAW,GAAGP,YAAY;EACjC;EAEA,IAAIQ,KAAKA,CAAA;IACP,OAAOC,IAAI,CAACC,KAAK,CAAC,IAAI,CAACH,WAAW,GAAG,IAAI,CAAC;EAC5C;EAEA;EACAI,SAASA,CAAEC,QAAgB,EAAEC,OAAe,EAAEC,QAAgB;IAC5D,IAAIF,QAAQ,IAAI,CAAC,IAAIC,OAAO,IAAID,QAAQ,EAAE;MACxC;;IAGF,MAAMG,SAAS,GAAG,CAACF,OAAO,GAAGD,QAAQ,IAAI,IAAI,GAAGE,QAAQ;IACxD,IAAIC,SAAS,IAAI,CAAC,EAAE;MAClB;;IAGF,IAAIC,MAAM,GAAGD,SAAS;IACtB,IAAIC,MAAM,GAAG,CAAC,GAAG,IAAI,CAACV,SAAS,EAAE;MAC/BU,MAAM,GAAGP,IAAI,CAACQ,IAAI,CAAC,KAAK,GAAGD,MAAM,CAAC;;IAGpC,IAAI,CAACV,SAAS,GAAGU,MAAM;IACvB,IAAI,IAAI,CAACX,MAAM,GAAGW,MAAM,IAAI,IAAI,CAACX,MAAM,KAAK,CAAC,EAAE;MAC7C,IAAI,CAACA,MAAM,GAAGW,MAAM;;IAEtB,IAAI,CAACT,WAAW,GAAGE,IAAI,CAACQ,IAAI,CAAC,IAAI,CAACV,WAAW,GAAGL,aAAa,GAAGc,MAAM,GAAGf,QAAQ,CAAC;EACpF;;AAnCFiB,OAAA,CAAAf,QAAA,GAAAA,QAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}